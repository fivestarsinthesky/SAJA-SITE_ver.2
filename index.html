<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<title>사자왕자의 노래방 | 포스터 그리드</title>
<style>
  :root { --gap: 8px; --tile-ratio: 56.25%; --maxw: 1600px; --hero: clamp(46px, 10.6vw, 173px); }

  /* ====== Title Bar sizing variables ====== */
  :root{
    --tb-sidePad: clamp(12px, 3vw, 24px);
    --tb-vertPad: clamp(8px,  2vw, 16px);
    --tb-gap:     clamp(8px,  2vw, 16px);
    --tb-centerW: clamp(180px, 42vw, 520px);
    --tb-rightW:  clamp(80px,  18vw, 240px);
  }

  * { box-sizing: border-box; }
  body {
    margin:0;
    font-family: system-ui, "Noto Sans KR", sans-serif;
    background: #fff url('./assets/poster.jpeg') no-repeat center center fixed; background-size: 100% 100%;
    color:#111;
    min-height: 100vh;
  }
  /* UPDATED: make grid stick right under the title */
  .wrap { max-width: var(--maxw); margin:0 auto; padding:24px 24px 28px; padding-top: var(--hero); }

  /* 기본 10열 */
  .grid { display:grid; grid-template-columns:repeat(10,1fr); gap:var(--gap); }
  .tile { position:relative; overflow:hidden; border-radius:12px; border: none; background:#f7f7f7; }
  .tile::before { content:""; display:block; padding-top: var(--tile-ratio); }
  .tile img { position:absolute; inset:0; width:100%; height:100%; object-fit:cover; transition:transform .2s; }
  .tile:hover img{ transform:scale(1.03); }

  /* 라벨: 한 줄 유지 + 가독성 */
  

.label{
  position:absolute; left:0; right:0; bottom:0;
  padding:6px 8px;
  color:#fff;
  background:linear-gradient(to top, rgba(0,0,0,.65), rgba(0,0,0,0));
  font-weight:700;
  font-size:14px; /* fixed */
  line-height:1.1;
  white-space:nowrap;
  overflow:hidden;
}
.label span{
  display:inline-block;
  will-change: transform;
  transform: translateX(0); /* rest: show from the start */
}
@keyframes scrollLeft{
  from { transform: translateX(0); }
  to   { transform: translateX(calc(-1 * var(--scrollW, 0px))); }
}

/* Default: mobile/no-hover → always scroll (infinite) */
@media (hover: none), (pointer: coarse){
  .label span{
    animation: scrollLeft var(--dur, 10s) linear infinite;
  }
}

/* PC/hover devices: rest, then scroll only on hover once */
@media (hover: hover) and (pointer: fine){
  .label span{ animation: none; }
  .label.is-scroll span{ animation: scrollLeft var(--dur, 10s) linear 0s 1 both; }
}

/* 접근성: 모션 감소 설정일 때는 정지 */
@media (prefers-reduced-motion: reduce){
  .label span{ animation:none !important; }
}


</style>
</head>
<body>
  <div class="title-fixed">
    <div class="title-bar">
      <div class="title-ghost"></div>
      <img class="title-center" src="./title1.png" alt="사자왕자의 노래방 타이틀(중앙)">
      <img class="title-right"  src="./title2.png" alt="사자왕자 캐릭터(오른쪽)">
    </div>
  </div>

  <main class="wrap">
    <nav aria-label="SNS 링크" class="sns-grid" style="margin-bottom:8px;">
      <a aria-label="YouTube" href="https://www.youtube.com/@lionprince.x" rel="noopener" target="_blank"><img alt="YouTube" src="./assets/icons/SNS01.png?v=20250812162819a"/></a>
      <a aria-label="X" href="https://x.com/" rel="noopener" target="_blank"><img alt="X" src="./assets/icons/SNS02.png?v=20250812162819b"/></a>
      <a aria-label="Naver Cafe" href="https://cafe.naver.com/" rel="noopener" target="_blank"><img alt="Naver Cafe" src="./assets/icons/SNS03.png?v=20250812162819c"/></a>
    </nav>
    <div class="grid" id="grid"></div>
  </main>

  <!-- 타이틀 높이에 맞춰 본문 밀기 -->
  <script>
  (function(){
    function setHero(){
      var t = document.querySelector('.title-fixed');
      if(!t) return;
      var h = t.getBoundingClientRect().height || 0;
      document.documentElement.style.setProperty('--hero', (h) + 'px');
    }
    if (document.readyState === 'complete' || document.readyState === 'interactive') {
      setTimeout(setHero, 0);
    } else {
      document.addEventListener('DOMContentLoaded', setHero);
    }
    var imgs = document.querySelectorAll('.title-fixed img');
    imgs.forEach(function(img){ img.addEventListener('load', setHero, { once:false }); });
    var tid;
    window.addEventListener('resize', function(){
      clearTimeout(tid);
      tid = setTimeout(setHero, 100);
    });
  })();
  </script>

  <!-- 데이터 로드 -->
  <script src="./assets/data/tracks.js?v=cache"></script>

  
  <!-- 그리드 렌더 -->
  <script>
  (function () {
    const grid = document.getElementById('grid');
    if (!grid) return;
    try {
      const data = (window.TRACKS && Array.isArray(window.TRACKS)) ? window.TRACKS : [];
      if (!data.length) {
        console.error('TRACKS 비어있음 또는 로드 실패');
        grid.innerHTML = '<div style="padding:24px;font-weight:700;">데이터가 없습니다. assets/data/tracks.js를 확인하세요.</div>';
        return;
      }
      const frag = document.createDocumentFragment();
      data.forEach(item => {
        const a = document.createElement('a');
        a.className = 'tile';
        if (item.ratio) a.style.setProperty('--tile-ratio', item.ratio);
        a.href = './detail.html?id=' + encodeURIComponent(item.id);
        a.innerHTML = `
          <img loading="lazy" src="${item.thumb}" alt="${item.artist} - ${item.title}">
          <div class="label"><span>${item.artist} - ${item.title}</span></div>
        `;
        frag.appendChild(a);
      });
      grid.innerHTML = '';
      grid.appendChild(frag);
    } catch (e) {
      console.error(e);
      grid.innerHTML = '<div style="padding:24px;font-weight:700;">스크립트 오류가 발생했습니다. 콘솔을 확인하세요.</div>';
    }
  })();
  </script>



<script>
(function(){
  function setupMarquees(){
    const tiles = document.querySelectorAll('.tile');
    const hasHover = matchMedia('(hover: hover) and (pointer: fine)').matches;

    tiles.forEach(tile => {
      const label = tile.querySelector('.label');
      const span  = tile.querySelector('.label > span');
      if(!label || !span) return;

      // Reset before measuring
      span.style.transform = 'translateX(0)';
      label.classList.remove('is-scroll');

      // Measure overflow relative to label box
      const overflow = Math.max(0, span.scrollWidth - label.clientWidth);
      label.style.setProperty('--scrollW', overflow + 'px');

      // Duration proportional to distance (px per second ~ 40), clamp 6s~18s
      const seconds = Math.min(18, Math.max(6, overflow / 40 + 6));
      label.style.setProperty('--dur', seconds + 's');

      if(hasHover){
        // Hover on the whole tile triggers the label scroll once
        const onEnter = () => {
          if(overflow > 0){
            label.classList.add('is-scroll');
          }
        };
        const onLeave = () => {
          label.classList.remove('is-scroll');
          span.style.transform = 'translateX(0)';
        };
        // Remove prior listeners to avoid stacking
        tile.removeEventListener('mouseenter', onEnter);
        tile.removeEventListener('mouseleave', onLeave);
        tile.addEventListener('mouseenter', onEnter);
        tile.addEventListener('mouseleave', onLeave);
      }
    });
  }

  // Run after initial render and on resize (debounced)
  let tid;
  window.addEventListener('resize', () => {
    clearTimeout(tid);
    tid = setTimeout(setupMarquees, 150);
  });
  window.addEventListener('load', setupMarquees, {once:true});
  setTimeout(setupMarquees, 150);
  setTimeout(setupMarquees, 600);
})();
</script>


</body>
</html>
