<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>사자왕자 · 포스터 그리드</title>
<style>
  :root { --gap: 8px; --tile-ratio: 56.25%; --maxw: 1600px; }
  * { box-sizing: border-box; }
  body { margin:0; font-family: system-ui, "Noto Sans KR", sans-serif; color:#111;
         background: url("./assets/bg.png") center / cover fixed no-repeat; }
  /* 가독성 오버레이 (선택) */
  body::before{
    content:""; position:fixed; inset:0; pointer-events:none;
    background: rgba(255,255,255,.05);
  }
  .wrap { max-width: var(--maxw); margin:0 auto; padding:24px 12px 28px; }
  .grid { display:grid; grid-template-columns:repeat(10,1fr); gap:var(--gap); }
  .tile { position:relative; overflow:hidden; border-radius:12px; border:1px solid #eee; background:#f7f7f7; }
  .tile::before { content:""; display:block; padding-top: var(--tile-ratio); }
  .tile img { position:absolute; inset:0; width:100%; height:100%; object-fit:cover; transition:transform .2s; }
  .tile:hover img{ transform:scale(1.03); }
  .label{ position:absolute; left:0; right:0; bottom:0; padding:6px 8px; font-size:12px; color:#fff;
          background:linear-gradient(to top, rgba(0,0,0,.55), rgba(0,0,0,0)); }

  @media (max-width:900px){
    .grid{ grid-template-columns:repeat(2,1fr); }
    .wrap{ padding:16px 10px 24px; }
  }
</style>
</head>
<body>
  <main class="wrap">
    <div id="grid" class="grid"></div>
  </main>

  <!-- 1) 데이터 먼저: 절대경로 + 캐시버스터 -->
  <script src="/assets/data/tracks.js?v=20250812"></script>

  <!-- 2) 안전 렌더 스크립트 -->
  <script>
  (function () {
    const grid = document.getElementById('grid');
    if (!grid) return;

    function msg(t) {
      grid.innerHTML = '<div style="padding:24px;font-weight:700;color:#fff;">'+t+'</div>';
    }

    try {
      const data = (window.TRACKS && Array.isArray(window.TRACKS)) ? window.TRACKS : [];
      if (!data.length) {
        console.error('TRACKS 비어있음 또는 로드 실패');
        msg('데이터가 없습니다. assets/data/tracks.js를 확인하세요.');
        return;
      }

      const frag = document.createDocumentFragment();
      data.forEach(item => {
        const a = document.createElement('a');
        a.className = 'tile';
        if (item.ratio) a.style.setProperty('--tile-ratio', item.ratio);
        a.href = './detail.html?id=' + encodeURIComponent(item.id);
        a.innerHTML = `
          <img loading="lazy" src="${item.thumb}" alt="${item.artist} — ${item.title}">
          <div class="label">${item.artist} — ${item.title}</div>
        `;
        frag.appendChild(a);
      });
      grid.innerHTML = '';
      grid.appendChild(frag);
    } catch (e) {
      console.error(e);
      msg('스크립트 오류가 발생했습니다. 콘솔을 확인하세요.');
    }
  })();
  </script>
</body>
</html>
